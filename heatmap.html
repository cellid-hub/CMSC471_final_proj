<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>

<!-- Load color palettes -->
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<script>
  var margin = { top: 50, right: 50, bottom: 100, left: 100 },
    width = 800 - margin.left - margin.right,
    height = 600 - margin.top - margin.bottom;

  // Append the svg object to the body of the page
  var svg = d3
    .select("body")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  // Load the data from the CSV file
  d3.csv("CLEANED_assignment_3_dataset.csv", function (data) {
    // Extract the columns we're interested in
    var countries = data.map(function (d) {
      return d.Country;
    });
    var years = data.map(function (d) {
      return d.Year;
    });
    var values = data.map(function (d) {
      return +d["GDP ($ USD billions PPP)"];
    });

    // Define the color scale
    var colorScale = d3
      .scaleSequential()
      .interpolator(d3.interpolateBlues)
      .domain(d3.extent(values));

    // Create the heatmap
    var heatmap = svg
      .selectAll()
      .data(data)
      .enter()
      .append("rect")
      .attr("x", function (d) {
        return years.indexOf(d.Year) * (width / years.length);
      })
      .attr("y", function (d) {
        return countries.indexOf(d.Country) * (height / countries.length);
      })
      .attr("width", width / years.length)
      .attr("height", height / countries.length)
      .style("fill", function (d) {
        return colorScale(+d["GDP ($ USD billions PPP)"]);
      });

    // Add the axes
    var xScale = d3.scaleBand().range([0, width]).domain(years).padding(0.01);
    var yScale = d3
      .scaleBand()
      .range([0, height])
      .domain(countries)
      .padding(0.01);
    var xAxis = d3.axisBottom(xScale);
    var yAxis = d3.axisLeft(yScale);
    svg
      .append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);
    svg.append("g").call(yAxis);
  });
</script>
